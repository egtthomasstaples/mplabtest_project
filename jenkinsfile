pipeline{
    agent {label 'Linux'}
    stages {
        stage('Checkout from SCM') {
            agent {
                docker
                {
                    alwaysPull false
                    reuseNode true
                    image 'mplabx-5.25_xc16-1.36'
                }  
            }
            steps {
                checkout scm
                // Generate make files 
                sh "/opt/microchip/mplabx/v5.25/mplab_platform/bin/prjMakefilesGenerator.sh -f ./mplab_project.x"
                // Clean output directory. 
                sh "rm -f -r build/default"
                sh "rm -f -r dist/default"
                // Build all targets
                sh "/opt/microchip/mplabx/v5.25/mplab_platform/bin/make --always-make all"
               
                sh "ls"
                sh "echo hello"
            }
        }
    }
}
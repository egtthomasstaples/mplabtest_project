pipeline{
    agent {label 'Linux'}
    stages {
        stage('Checkout from SCM') {
            agent {
                docker
                {
                    alwaysPull false
                    reuseNode true
                    image 'mplabx-5.25_xc16-1.36'
                }  
            }
            steps {
                checkout scm
                sh "ls"
                // Generate make files 
                sh "/opt/microchip/mplabx/v5.25/mplab_platform/bin/prjMakefilesGenerator.sh -f ./mplab_second_project.X"
                // Clean output directory. 
                sh "cd mplab_second_project.X/"
                sh "ls"
                sh "/opt/microchip/mplabx/v5.25/mplab_platform/bin/make ./mplab_second_project.X/clean"
                // Build all targets
                sh "/opt/microchip/mplabx/v5.25/mplab_platform/bin/make ./mplab_second_project.X/ --always-make all"
               
                sh "ls"
                sh "echo hello"
            }
        }
    }
}